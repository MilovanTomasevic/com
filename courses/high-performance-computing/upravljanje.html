<!DOCTYPE html><html><head><title>[High-performance computing (HPC)](/courses/#table-of-contents)</title><meta charset="utf-8"><style>@import url(https://fonts.googleapis.com/css?family=Playfair+Display);@import url(https://fonts.googleapis.com/css?family=Droid+Serif);@import url(https://fonts.googleapis.com/css?family=Open+Sans);@import url(https://fonts.googleapis.com/css?family=Work+Sans);@import url(https://fonts.googleapis.com/css?family=Muli);@import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);@import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);@import url(https://fonts.googleapis.com/css?family=Roboto+Condensed);@import url(https://fonts.googleapis.com/css?family=PT+Sans);@import url(https://fonts.googleapis.com/css?family=Roboto);body{font-family:'Open Sans';color:#333;display:flex;height:100%}h1{font-family:"Playfair Display"}h2,h3,h4{font-family:'Yanone Kaffeesatz';font-weight:400}a{font-family:"PT Sans"}.remark-slide-content h1{font-size:3em}.remark-slide-content h2{font-size:2em}.remark-slide-content h3{font-size:1.6em}.remark-code,.remark-inline-code{font-family:'Ubuntu Mono'}.remark-code-line-highlighted{background-color:#373832}h1{text-shadow:-1px 0 #000,0 1px #000,1px 0 #000,0 -1px #000;-webkit-animation:pulse 7s forwards;-moz-animation:pulse 7s forwards;-o-animation:pulse 7s forwards;-ms-animation:pulse 7s forwards;animation:pulse 7s forwards}@-webkit-keyframes pulse{0%{color:#eee}100%{color:#666}}@-moz-keyframes pulse{0%{color:#eee}100%{color:#666}}@-ms-keyframes pulse{0%{color:#eee}100%{color:#666}}@-o-keyframes pulse{0%{color:#eee}100%{color:#666}}@keyframes pulse{0%{color:#eee}100%{color:#666}}h2{-webkit-animation:color-change 1.5s infinite;-moz-animation:color-change 1.5s infinite;-o-animation:color-change 1.5s infinite;-ms-animation:color-change 1.5s infinite;animation:color-change 1.5s infinite}@-webkit-keyframes color-change{0%{color:coral}50%{color:#5db9e0}100%{color:coral}}@-moz-keyframes color-change{0%{color:coral}50%{color:#5db9e0}100%{color:coral}}@-ms-keyframes color-change{0%{color:coral}50%{color:#5db9e0}100%{color:coral}}@-o-keyframes color-change{0%{color:coral}50%{color:#5db9e0}100%{color:coral}}@keyframes color-change{0%{color:coral}50%{color:#5db9e0}100%{color:coral}}h3,h4{color:#c7e2ee;text-shadow:-.7px 0 #4d4d4d,0 .7px #4d4d4d,.7px 0 #4d4d4d,0 -.7px #4d4d4d}.theend{background-color:#000;color:#000;text-shadow:0 0 20px #333}.inverse{background-color:#7e7e7e;color:#c5dae4;text-shadow:0 0 20px #333}.inverse h1{text-shadow:-1px 0 #000,0 1px #000,1px 0 #000,0 -1px #000;-webkit-animation:pulsei 7s forwards;-moz-animation:pulsei 7s forwards;-o-animation:pulsei 7s forwards;-ms-animation:pulsei 7s forwards;animation:pulsei 7s forwards}@-webkit-keyframes pulsei{0%{color:#eee}100%{color:#e9a46b}}@-moz-keyframes pulsei{0%{color:#eee}100%{color:#e9a46b}}@-ms-keyframes pulsei{0%{color:#eee}100%{color:#e9a46b}}@-o-keyframes pulsei{0%{color:#eee}100%{color:#e9a46b}}@keyframes pulsei{0%{color:#eee}100%{color:#e9a46b}}.inverse h2{text-shadow:-1px 0 #000,0 1px #000,1px 0 #000,0 -1px #000;-webkit-animation:color-changei 1s infinite;-moz-animation:color-changei 1s infinite;-o-animation:color-changei 1s infinite;-ms-animation:color-changei 1s infinite;animation:color-changei 1s infinite}@-webkit-keyframes color-changei{0%{color:#fff}50%{color:#7bbcd8}100%{color:#fff}}@-moz-keyframes color-changei{0%{color:#fff}50%{color:#7bbcd8}100%{color:#fff}}@-ms-keyframes color-changei{0%{color:#fff}50%{color:#7bbcd8}100%{color:#fff}}@-o-keyframes color-changei{0%{color:#fff}50%{color:#7bbcd8}100%{color:#fff}}@keyframes color-changei{0%{color:#fff}50%{color:#7bbcd8}100%{color:#fff}}a{color:#bb7917;text-decoration:none;transition:all .3s linear;-webkit-transition:all .3s linear;-moz-transition:all .3s linear;background:linear-gradient(to bottom,var(--mainColor) 0,var(--mainColor) 100%);background-position:0 100%;background-repeat:repeat-x;background-size:1.5px 1.5px}a:hover{background-image:url("data:image/svg+xml;charset=utf8,%3Csvg id='squiggle-link' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns:ev='http://www.w3.org/2001/xml-events' viewBox='0 0 20 4'%3E%3Cstyle type='text/css'%3E.squiggle{animation:shift .3s linear infinite;}@keyframes shift {from {transform:translateX(0);}to {transform:translateX(-20px);}}%3C/style%3E%3Cpath fill='none' stroke='%23ff9800' stroke-width='2' class='squiggle' d='M0,3.5 c 5,0,5,-3,10,-3 s 5,3,10,3 c 5,0,5,-3,10,-3 s 5,3,10,3'/%3E%3C/svg%3E");background-position:0 100%;background-size:auto 4px;background-repeat:repeat-x;text-decoration:none;color:#2d77d8;padding-left:10px}.inverse code{background-color:#7e7e7e}.hide-text{text-indent:-9999px}.remark-slide-container{transition:opacity 1s linear,right 1s ease-in-out;opacity:0;right:1000px}.remark-visible{transition:opacity 1s linear,right 1s ease-in-out;opacity:1;right:0}.remark-fading{z-index:9}.remark-visible~.remark-slide-container{right:-1000px}.remark-code,.remark-inline-code{font-family:'Ubuntu Mono'}.remark-code-line-highlighted{background-color:#373832}.remark-inline-code{font-weight:700}.remark-code-line-highlighted{font-weight:700;background-color:transparent;text-shadow:0 5px 15px rgba(255,106,20,.5),5px 0 15px rgba(255,106,20,.5),-5px 0 15px rgba(255,106,20,.5),0 -5px 15px rgba(255,106,20,.5)}.shade{padding:0}.shade{background-color:rgba(0,0,0,.7);color:#fff;width:100%;padding:1em 0}.shadelight{background-color:rgba(0,0,0,.5);color:#fff;width:100%;padding:0}.fgtransparent h1{color:rgba(255,255,255,.8)!important;text-shadow:none}.boxtitle1{padding:1em;text-align:left;border-left:rgba(255,255,255,.6) solid .5em;border-right:#fff solid 0}.nosplit>div:first-of-type{width:100%;height:100%;position:absolute;top:0;left:0}.split-20>div:first-of-type{width:20%;height:100%;position:absolute;top:0;left:0}.split-20>div:nth-of-type(2){width:80%;height:100%;position:absolute;top:0;right:0}.split-30>div:first-of-type{width:30%;height:100%;position:absolute;top:0;left:0}.split-30>div:nth-of-type(2){width:70%;height:100%;position:absolute;top:0;right:0}.split-50>div:first-of-type{width:50%;height:100%;position:absolute;top:0;left:0}.split-50>div:nth-of-type(2){width:50%;height:100%;position:absolute;top:0;right:0}.split-60>div:first-of-type{width:60%;height:100%;position:absolute;top:0;left:0}.split-60>div:nth-of-type(2){width:40%;height:100%;position:absolute;top:0;right:0}.split-70>div:first-of-type{width:70%;height:100%;position:absolute;top:0;left:0}.split-70>div:nth-of-type(2){width:30%;height:100%;position:absolute;top:0;right:0}.column_t1{background-color:#2aa9df;color:#fff}.column_t1 a{color:#b3e5fc}.column_t1 pre code{-webkit-box-shadow:0 0 55px 0 rgba(0,0,0,.75);-moz-box-shadow:0 0 55px 0 rgba(0,0,0,.75);box-shadow:0 0 55px 0 rgba(0,0,0,.75)}.uline{text-decoration:underline}.vmiddle{position:relative;top:50%;transform:translateY(-50%);padding:1em}.remark-slide-content h1{font-size:50px}.remark-slide-content h2{font-size:40px}.remark-slide-content h3{font-size:30px}.remark-slide-content img{width:100%}.remark-slide-content{padding-left:50px;padding-right:50px}.remark-slide-content{background-size:contain}blockquote{font-family:'Playfair Display';font-style:italic;font-size:110%;margin-top:10px;margin-bottom:10px;margin-left:50px;padding:1em 1em;background-color:#f5f5f5;border-left:5px solid #dbdbdb}.hljs-ln td.hljs-ln-numbers{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-align:center;color:#ccc;border-right:1px solid #ccc;vertical-align:top;padding-right:5px}.hljs-ln td.hljs-ln-code{padding-left:10px}.lcol{width:49%;float:left}.lcol-narrow{width:39%;float:left}.lcol-narrow2{width:24%;float:left}.lcol-wide{width:59%;float:left}.lcol-wide2{width:74%;float:left}.rcol{width:49%;float:right}.rcol-narrow{width:39%;float:right}.rcol-narrow2{width:24%;float:right}.rcol-wide{width:59%;float:right}.rcol-wide2{width:74%;float:right}.wide{clear:both}.l-col{color:#777;width:20%;height:92%;float:left}.r-col{width:75%;float:right;padding-top:1em}code{-moz-border-radius:5px;-web-border-radius:5px;border-radius:5px;background:#e7e8e2}em{color:#c63235}.remark-slide-content{font-size:24px}ol>li,ul>li{margin-top:5px}.section{font-size:16px;float:right;clear:both}.small,.small .remark-code-line{font-size:60%}.medium,.medium .remark-code-line{font-size:80%}.condensed{line-height:.8em;font-size:90%}.size-90,.size-90 .remark-code-line{font-size:90%}.size-85,.size-85 .remark-code-line{font-size:85%}.multicode pre{margin-top:10px;margin-bottom:10px}.remark-slide img,.remark-slide pre{margin-top:25px;margin-bottom:25px}.attention{-moz-border-radius:5px;-web-border-radius:5px;border-radius:5px;background-color:#fbd2d2;text-align:center}.attention p{margin:10px}.footer{position:absolute;bottom:12px;left:20px;font-size:70%}.footer.small{font-size:50%}.footer,li>p{margin:0}.ref{color:red;vertical-align:super;font-size:70%}.created{font-size:60%;margin-bottom:5em;font-family:"Playfair Display";font-size:16px;font-style:normal;font-variant:normal;font-weight:400;line-height:22px}.created:before{content:"üë®üèª‚Äçüíª‚ûô "}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.overlay{box-shadow:inset 0 0 0 9999px rgba(0,0,0,.35)}.container{height:100%;width:100%;display:flex;position:fixed;align-items:center;justify-content:center}table{border-collapse:collapse;border-spacing:0;empty-cells:show;border:1px solid #cbcbcb}.center-table table{margin:0 auto}table caption{color:#000;font:italic 85%/1 arial,sans-serif;padding:1em 0;text-align:center}table td,table th{border-left:1px solid #cbcbcb;border-width:0 0 0 1px;font-size:inherit;margin:0;overflow:visible;padding:.5em 1em}table td:first-child,table th:first-child{border-left-width:0}table thead{background-color:#e0e0e0;color:#000;text-align:left;vertical-align:bottom}table td{background-color:transparent}table-odd td{background-color:#f2f2f2}table tr:nth-child(2n-1) td{background-color:#f2f2f2}table td{border-bottom:1px solid #cbcbcb}table tbody>tr:last-child>td{border-bottom-width:0}table-horizontal td,table-horizontal th{border-width:0 0 1px 0;border-bottom:1px solid #cbcbcb}table-horizontal tbody>tr:last-child>td{border-bottom-width:0}/*! bulma.io v0.4.2 | MIT License | github.com/jgthms/bulma */@-webkit-keyframes spinAround{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes spinAround{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}/*! minireset.css v0.0.2 | MIT License | github.com/jgthms/minireset.css */p{margin:0;padding:0}.message{font-family:'Playfair Display';background-color:#f5f5f5;border-radius:3px;font-size:1rem}.message:not(:last-child){margin-bottom:1.5rem}.message.is-white{background-color:#fff}.message.is-white .message-header{background-color:#fff;color:#0a0a0a}.message.is-white .message-body{border-color:#fff;color:#4d4d4d}.message.is-black{background-color:#fafafa}.message.is-black .message-header{background-color:#0a0a0a;color:#fff}.message.is-black .message-body{border-color:#0a0a0a;color:#090909}.message.is-light{background-color:#fafafa}.message.is-light .message-header{background-color:#f5f5f5;color:#363636}.message.is-light .message-body{border-color:#f5f5f5;color:#505050}.message.is-dark{background-color:#fafafa}.message.is-dark .message-header{background-color:#363636;color:#f5f5f5}.message.is-dark .message-body{border-color:#363636;color:#2a2a2a}.message.is-primary{background-color:#f5fffd}.message.is-primary .message-header{background-color:#00d1b2;color:#fff}.message.is-primary .message-body{border-color:#00d1b2;color:#021310}.message.is-info{background-color:#f6f9fe}.message.is-info .message-header{background-color:#3273dc;color:#fff}.message.is-info .message-body{border-color:#3273dc;color:#22509a}.message.is-success{background-color:#f6fef9}.message.is-success .message-header{background-color:#23d160;color:#fff}.message.is-success .message-body{border-color:#23d160;color:#0e301a}.message.is-warning{background-color:#fffdf5}.message.is-warning .message-header{background-color:#ffdd57;color:rgba(0,0,0,.7)}.message.is-warning .message-body{border-color:#ffdd57;color:#3b3108}.message.is-danger{background-color:#fff5f7}.message.is-danger .message-header{background-color:#ff3860;color:#fff}.message.is-danger .message-body{border-color:#ff3860;color:#cd0930}.message-header{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:#4a4a4a;border-radius:3px 3px 0 0;color:#fff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;line-height:1.25;padding:.5em .75em;position:relative}.message-header a,.message-header strong{color:inherit}.message-header a{text-decoration:underline}.message-header .delete{-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0;-ms-flex-negative:0;flex-shrink:0;margin-left:.75em}.message-header+.message-body{border-top-left-radius:0;border-top-right-radius:0;border-top:none}.message-body{border:1px solid #dbdbdb;border-radius:3px;color:#4a4a4a;padding:.1em .5em}.message-body a,.message-body strong{color:inherit}.message-body a{text-decoration:underline}.message-body code,.message-body pre{background:#fff}.message-body pre code{background:0 0}.column{display:block;-ms-flex-preferred-size:0;flex-basis:0;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-negative:1;flex-shrink:1;padding:.75rem}.columns.is-mobile>.column.is-narrow{-webkit-box-flex:0;-ms-flex:none;flex:none}.columns.is-mobile>.column.is-full{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.columns.is-mobile>.column.is-three-quarters{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.columns.is-mobile>.column.is-two-thirds{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.columns.is-mobile>.column.is-half{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.columns.is-mobile>.column.is-one-third{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.columns.is-mobile>.column.is-one-quarter{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.columns.is-mobile>.column.is-offset-three-quarters{margin-left:75%}.columns.is-mobile>.column.is-offset-two-thirds{margin-left:66.6666%}.columns.is-mobile>.column.is-offset-half{margin-left:50%}.columns.is-mobile>.column.is-offset-one-third{margin-left:33.3333%}.columns.is-mobile>.column.is-offset-one-quarter{margin-left:25%}.columns.is-mobile>.column.is-1{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.columns.is-mobile>.column.is-offset-1{margin-left:8.33333%}.columns.is-mobile>.column.is-2{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.columns.is-mobile>.column.is-offset-2{margin-left:16.66667%}.columns.is-mobile>.column.is-3{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.columns.is-mobile>.column.is-offset-3{margin-left:25%}.columns.is-mobile>.column.is-4{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.columns.is-mobile>.column.is-offset-4{margin-left:33.33333%}.columns.is-mobile>.column.is-5{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.columns.is-mobile>.column.is-offset-5{margin-left:41.66667%}.columns.is-mobile>.column.is-6{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.columns.is-mobile>.column.is-offset-6{margin-left:50%}.columns.is-mobile>.column.is-7{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.columns.is-mobile>.column.is-offset-7{margin-left:58.33333%}.columns.is-mobile>.column.is-8{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.columns.is-mobile>.column.is-offset-8{margin-left:66.66667%}.columns.is-mobile>.column.is-9{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.columns.is-mobile>.column.is-offset-9{margin-left:75%}.columns.is-mobile>.column.is-10{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.columns.is-mobile>.column.is-offset-10{margin-left:83.33333%}.columns.is-mobile>.column.is-11{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.columns.is-mobile>.column.is-offset-11{margin-left:91.66667%}.columns.is-mobile>.column.is-12{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.columns.is-mobile>.column.is-offset-12{margin-left:100%}@media screen and (max-width:768px){.column.is-narrow-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none}.column.is-full-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-three-quarters-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-two-thirds-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.column.is-half-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-one-third-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.column.is-one-quarter-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-three-quarters-mobile{margin-left:75%}.column.is-offset-two-thirds-mobile{margin-left:66.6666%}.column.is-offset-half-mobile{margin-left:50%}.column.is-offset-one-third-mobile{margin-left:33.3333%}.column.is-offset-one-quarter-mobile{margin-left:25%}.column.is-1-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.column.is-offset-1-mobile{margin-left:8.33333%}.column.is-2-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.column.is-offset-2-mobile{margin-left:16.66667%}.column.is-3-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-3-mobile{margin-left:25%}.column.is-4-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.column.is-offset-4-mobile{margin-left:33.33333%}.column.is-5-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.column.is-offset-5-mobile{margin-left:41.66667%}.column.is-6-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-offset-6-mobile{margin-left:50%}.column.is-7-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.column.is-offset-7-mobile{margin-left:58.33333%}.column.is-8-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.column.is-offset-8-mobile{margin-left:66.66667%}.column.is-9-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-offset-9-mobile{margin-left:75%}.column.is-10-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.column.is-offset-10-mobile{margin-left:83.33333%}.column.is-11-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.column.is-offset-11-mobile{margin-left:91.66667%}.column.is-12-mobile{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-offset-12-mobile{margin-left:100%}}@media screen and (min-width:769px),print{.column.is-narrow,.column.is-narrow-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none}.column.is-full,.column.is-full-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-three-quarters,.column.is-three-quarters-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-two-thirds,.column.is-two-thirds-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.column.is-half,.column.is-half-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-one-third,.column.is-one-third-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.column.is-one-quarter,.column.is-one-quarter-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-three-quarters,.column.is-offset-three-quarters-tablet{margin-left:75%}.column.is-offset-two-thirds,.column.is-offset-two-thirds-tablet{margin-left:66.6666%}.column.is-offset-half,.column.is-offset-half-tablet{margin-left:50%}.column.is-offset-one-third,.column.is-offset-one-third-tablet{margin-left:33.3333%}.column.is-offset-one-quarter,.column.is-offset-one-quarter-tablet{margin-left:25%}.column.is-1,.column.is-1-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.column.is-offset-1,.column.is-offset-1-tablet{margin-left:8.33333%}.column.is-2,.column.is-2-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.column.is-offset-2,.column.is-offset-2-tablet{margin-left:16.66667%}.column.is-3,.column.is-3-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-3,.column.is-offset-3-tablet{margin-left:25%}.column.is-4,.column.is-4-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.column.is-offset-4,.column.is-offset-4-tablet{margin-left:33.33333%}.column.is-5,.column.is-5-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.column.is-offset-5,.column.is-offset-5-tablet{margin-left:41.66667%}.column.is-6,.column.is-6-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-offset-6,.column.is-offset-6-tablet{margin-left:50%}.column.is-7,.column.is-7-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.column.is-offset-7,.column.is-offset-7-tablet{margin-left:58.33333%}.column.is-8,.column.is-8-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.column.is-offset-8,.column.is-offset-8-tablet{margin-left:66.66667%}.column.is-9,.column.is-9-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-offset-9,.column.is-offset-9-tablet{margin-left:75%}.column.is-10,.column.is-10-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.column.is-offset-10,.column.is-offset-10-tablet{margin-left:83.33333%}.column.is-11,.column.is-11-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.column.is-offset-11,.column.is-offset-11-tablet{margin-left:91.66667%}.column.is-12,.column.is-12-tablet{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-offset-12,.column.is-offset-12-tablet{margin-left:100%}}@media screen and (max-width:999px){.column.is-narrow-touch{-webkit-box-flex:0;-ms-flex:none;flex:none}.column.is-full-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-three-quarters-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-two-thirds-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.column.is-half-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-one-third-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.column.is-one-quarter-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-three-quarters-touch{margin-left:75%}.column.is-offset-two-thirds-touch{margin-left:66.6666%}.column.is-offset-half-touch{margin-left:50%}.column.is-offset-one-third-touch{margin-left:33.3333%}.column.is-offset-one-quarter-touch{margin-left:25%}.column.is-1-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.column.is-offset-1-touch{margin-left:8.33333%}.column.is-2-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.column.is-offset-2-touch{margin-left:16.66667%}.column.is-3-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-3-touch{margin-left:25%}.column.is-4-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.column.is-offset-4-touch{margin-left:33.33333%}.column.is-5-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.column.is-offset-5-touch{margin-left:41.66667%}.column.is-6-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-offset-6-touch{margin-left:50%}.column.is-7-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.column.is-offset-7-touch{margin-left:58.33333%}.column.is-8-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.column.is-offset-8-touch{margin-left:66.66667%}.column.is-9-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-offset-9-touch{margin-left:75%}.column.is-10-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.column.is-offset-10-touch{margin-left:83.33333%}.column.is-11-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.column.is-offset-11-touch{margin-left:91.66667%}.column.is-12-touch{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-offset-12-touch{margin-left:100%}}@media screen and (min-width:1000px){.column.is-narrow-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none}.column.is-full-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-three-quarters-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-two-thirds-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.column.is-half-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-one-third-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.column.is-one-quarter-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-three-quarters-desktop{margin-left:75%}.column.is-offset-two-thirds-desktop{margin-left:66.6666%}.column.is-offset-half-desktop{margin-left:50%}.column.is-offset-one-third-desktop{margin-left:33.3333%}.column.is-offset-one-quarter-desktop{margin-left:25%}.column.is-1-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.column.is-offset-1-desktop{margin-left:8.33333%}.column.is-2-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.column.is-offset-2-desktop{margin-left:16.66667%}.column.is-3-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-3-desktop{margin-left:25%}.column.is-4-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.column.is-offset-4-desktop{margin-left:33.33333%}.column.is-5-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.column.is-offset-5-desktop{margin-left:41.66667%}.column.is-6-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-offset-6-desktop{margin-left:50%}.column.is-7-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.column.is-offset-7-desktop{margin-left:58.33333%}.column.is-8-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.column.is-offset-8-desktop{margin-left:66.66667%}.column.is-9-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-offset-9-desktop{margin-left:75%}.column.is-10-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.column.is-offset-10-desktop{margin-left:83.33333%}.column.is-11-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.column.is-offset-11-desktop{margin-left:91.66667%}.column.is-12-desktop{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-offset-12-desktop{margin-left:100%}}@media screen and (min-width:1192px){.column.is-narrow-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none}.column.is-full-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-three-quarters-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-two-thirds-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.column.is-half-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-one-third-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.column.is-one-quarter-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-three-quarters-widescreen{margin-left:75%}.column.is-offset-two-thirds-widescreen{margin-left:66.6666%}.column.is-offset-half-widescreen{margin-left:50%}.column.is-offset-one-third-widescreen{margin-left:33.3333%}.column.is-offset-one-quarter-widescreen{margin-left:25%}.column.is-1-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.column.is-offset-1-widescreen{margin-left:8.33333%}.column.is-2-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.column.is-offset-2-widescreen{margin-left:16.66667%}.column.is-3-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-3-widescreen{margin-left:25%}.column.is-4-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.column.is-offset-4-widescreen{margin-left:33.33333%}.column.is-5-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.column.is-offset-5-widescreen{margin-left:41.66667%}.column.is-6-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-offset-6-widescreen{margin-left:50%}.column.is-7-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.column.is-offset-7-widescreen{margin-left:58.33333%}.column.is-8-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.column.is-offset-8-widescreen{margin-left:66.66667%}.column.is-9-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-offset-9-widescreen{margin-left:75%}.column.is-10-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.column.is-offset-10-widescreen{margin-left:83.33333%}.column.is-11-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.column.is-offset-11-widescreen{margin-left:91.66667%}.column.is-12-widescreen{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-offset-12-widescreen{margin-left:100%}}@media screen and (min-width:1384px){.column.is-narrow-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none}.column.is-full-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-three-quarters-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-two-thirds-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.6666%}.column.is-half-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-one-third-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.3333%}.column.is-one-quarter-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-three-quarters-fullhd{margin-left:75%}.column.is-offset-two-thirds-fullhd{margin-left:66.6666%}.column.is-offset-half-fullhd{margin-left:50%}.column.is-offset-one-third-fullhd{margin-left:33.3333%}.column.is-offset-one-quarter-fullhd{margin-left:25%}.column.is-1-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:8.33333%}.column.is-offset-1-fullhd{margin-left:8.33333%}.column.is-2-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:16.66667%}.column.is-offset-2-fullhd{margin-left:16.66667%}.column.is-3-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:25%}.column.is-offset-3-fullhd{margin-left:25%}.column.is-4-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:33.33333%}.column.is-offset-4-fullhd{margin-left:33.33333%}.column.is-5-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:41.66667%}.column.is-offset-5-fullhd{margin-left:41.66667%}.column.is-6-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:50%}.column.is-offset-6-fullhd{margin-left:50%}.column.is-7-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:58.33333%}.column.is-offset-7-fullhd{margin-left:58.33333%}.column.is-8-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:66.66667%}.column.is-offset-8-fullhd{margin-left:66.66667%}.column.is-9-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:75%}.column.is-offset-9-fullhd{margin-left:75%}.column.is-10-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:83.33333%}.column.is-offset-10-fullhd{margin-left:83.33333%}.column.is-11-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:91.66667%}.column.is-offset-11-fullhd{margin-left:91.66667%}.column.is-12-fullhd{-webkit-box-flex:0;-ms-flex:none;flex:none;width:100%}.column.is-offset-12-fullhd{margin-left:100%}}.columns{margin-left:-.75rem;margin-right:-.75rem;margin-top:-.75rem}.columns:last-child{margin-bottom:-.75rem}.columns:not(:last-child){margin-bottom:.75rem}.columns.is-centered{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.columns.is-gapless{margin-left:0;margin-right:0;margin-top:0}.columns.is-gapless:last-child{margin-bottom:0}.columns.is-gapless:not(:last-child){margin-bottom:1.5rem}.columns.is-gapless>.column{margin:0;padding:0}@media screen and (min-width:769px){.columns.is-grid{-ms-flex-wrap:wrap;flex-wrap:wrap}.columns.is-grid>.column{max-width:33.3333%;padding:.75rem;width:33.3333%}.columns.is-grid>.column+.column{margin-left:0}}.columns.is-mobile{display:-webkit-box;display:-ms-flexbox;display:flex}.columns.is-multiline{-ms-flex-wrap:wrap;flex-wrap:wrap}.columns.is-vcentered{-webkit-box-align:center;-ms-flex-align:center;align-items:center}@media screen and (min-width:769px){.columns:not(.is-desktop){display:-webkit-box;display:-ms-flexbox;display:flex}}@media screen and (min-width:1000px){.columns.is-desktop{display:-webkit-box;display:-ms-flexbox;display:flex}}.label{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:3px 5px 4px;color:#fff;font-weight:700;text-transform:uppercase;white-space:nowrap;font-size:.75em;left:10px;top:-15px;position:relative}div.box p,div.box ul{position:relative;top:-20px}.box.moody .label{background-color:#f89406}.box.happy .label{background-color:#46a546}.box.angry .label{background-color:#c43c35}code,div.box{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;padding:0 5px;border:1px solid #ccc;margin-bottom:25px;font-size:.9em}.angry{background-color:#ffd7d5;border-color:#c43c35}.happy{background-color:#c0e0c0;border-color:#46a546}.moody{background-color:#ffecd1;border-color:#f89406}@page{size:1210px 681px;margin:0}@media print{.remark-slide-scaler{width:100%!important;height:100%!important;transform:scale(1)!important;top:0!important;left:0!important}}</style><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script> <script src="https://cdn.jsdelivr.net/npm/highlightjs-line-numbers.js@2.6.0/dist/highlightjs-line-numbers.min.js"></script> <script>hljs.initHighlightingOnLoad();hljs.initLineNumbersOnLoad();</script> <link rel="stylesheet2" href="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.0.10/mermaid.min.css"> <script>mermaid.initialize({startOnLoad:true});</script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127734928-1"></script> <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);} gtag('js',new Date());gtag('config','UA-127734928-1');</script> <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-127734928-1','auto');ga('send','pageview');</script> </head><body> <script>if(window.location.search.match(/print-pdf/gi)){var link=document.createElement('link');link.rel='stylesheet';link.type='text/css';link.href='../pdf.css';document.getElementsByTagName('head')[0].appendChild(link);}</script> <textarea id="source">class: center, middle

## [High-performance computing (HPC)](/courses/#table-of-contents)
### Upravljanje


.author[[Milovan Toma≈°eviƒá, Ph.D.](https://www.milovantomasevic.com/)]

.small[</br>[üåê‚ûô milovantomasevic.com](https://milovantomasevic.com)</br> [‚úé‚ûô mt@milovantomasevic.com](mailto:mt@milovantomasevic.com)]



.created[26.03.2019 u 11:02]


---



class: split-20 nopadding
background-image: url(../key.jpg)

.column_t2.center[.vmiddle[
.fgtransparent[
![:scale 80%](../zahvalnica.png)
]
]]
.column_t2[.vmiddle.nopadding[
.shadelight[.boxtitle1[
.small[
## Acknowledgements

#### University of Novi Sad | Serbia

- [Veljko Petroviƒá, Ph.D., Assistant Professor](http://www.acs.uns.ac.rs/en/user/30)
- [Gorana Gojiƒá, MS, Teaching assistant](http://www.acs.uns.ac.rs/en/user/49)
- [Faculty of Technical Sciences](http://ftn.uns.ac.rs/)
- [Computing and Control Department | Chair for Applied Computer Sciences](http://www.acs.uns.ac.rs/en)
]]]
]]

.footer.small[
- #### Slides are created according to sources in the literature & Acknowledgements
]

---

name: start
class: center, middle, inverse

# Upravljanje HPC sistemima
## zateƒçeno stanje, performanse i upravljanja

---
name: sadrzaj

# Sadr≈æaj

- [Zateƒçeno stanje](#stanje)
- [Merenje performansi HPC sistema](#merenjeHPC)
- [Tehnike upravljanja HPC sistemima](#tehnikeHPC)
- [SLURM](#slurm)

---
name: stanje
class: center, middle, inverse

# Zateƒçeno stanje
## ≈°ta imamo?

---
layout: true

.section[[Zateƒçeno stanje](#sadrzaj)]

---

## Commodity Cluster i MPA

- Dosta je priƒçe o tome kako raƒçunari mo≈æda izgledaju i kako su nekad izgledali.
- Kako izgleda super-raƒçunar danas?
    - Kljuƒçnije: 
        - Kako izgleda super-raƒçunar koji mi koristimo.

---

## Arhitektura ugrubo

- Imamo vi≈°e ƒçvorova koji su povezani nekakvom mre≈æom.
- Svaki ƒçvor ima:
    - `n` fiziƒçkih procesora koji imaju
    - `m` logiƒçkih procesora (jezgara) koji podr≈æavaju
    - `k` niti izvr≈°avanja
    - neku koliƒçinu memorije koji ti procesori dele
    - `g` kartica za ubrzanje sa svojim specijalizovanim resursima za proraƒçunavanje

- Ti ƒçvorovi su povezani u jedan sistem kroz nekakvu mre≈æu

---

## U praksi‚Ä¶

- Raƒçunari sa kojima mi radimo ƒáe gotovo sigurno biti commodity cluster tipa.
- To znaƒçi 1 ƒçvor = 1 PC
- Taj neki ƒçvor ima:
    - 1 procesor
    - ~4 jezgara koji podr≈æavaju po
    - 2 niti izvr≈°avanja
    - Neki broj GB memorije (~16GB)

    - jednu ili dve grafiƒçke kartice `NVidia` tipa

- Svi ƒçvorovi su povezani na brzu `Ethernet` mre≈æu.

---

## U praksi‚Ä¶

- Svaki raƒçunar je individualna ma≈°ina, sa svojom instalacijom Linux-a.
- Na svakom raƒçunaru su instalirani odreƒëeni alati, biblioteke, itd. koje omoguƒáavaju da se resursi izmeƒëu raƒçunara efektno iskoriste.
- Primer:
    - `OpenMP`  nam omoguƒáava da koristimo paralelizam na nivou te jedne ma≈°ine.

- `OpenMPI` nam omoguƒáava da koristimo paralelizam izmeƒëu ma≈°ina.
- `OpenACC`  nam omoguƒáava da koristimo `CUDA` resurse na udoban naƒçin.
- `SLURM` nam omoguƒáava da kontroli≈°emo ≈°ta se izvr≈°ava i gde.

---

### Na≈° plan

- Da bi savladali ovo, na≈° plan jeste da:
    - `Benchmarking`. Nauƒçimo kako merimo i biramo super-raƒçunarsku instalaciju.
    - `Resource management`. Nauƒçimo kako da upravljamo onim ≈°to imamo.
    - `Parallel programming`. Nauƒçimo tehnologije koje nam omoguƒáavaju paralelizme.
    - `The Problem`. Savladamo neke primere problema sa kojima se suoƒçavamo i smislimo kako da ih ubrzamo.
    - `Domain specific libraries`. Nauƒçimo kako da koristimo specijalizovane biblioteke za istu svrhu.
    - `Profiling`. Nauƒçimo kako da izmerimo to ≈°to smo napravili.
    - `Visualization`. Nauƒçimo kako da prika≈æemo ≈°ta smo izraƒçunali.
    
---

layout: false
name: merenjeHPC
class: center, middle, inverse

# Merenje performansi HPC sistema
## koliko je brzo `brzo`?

---
layout: true

.section[[Merenje performansi HPC sistema](#sadrzaj)]

---
## Koncept

- Sabiranje performansi konstituenata HPC sistema proizvodi nekakve brojeve: toliko-i-toliko FLOPS-a.
- To nisu osobito korisni brojevi. Mogli bi i da sabiramo te≈æine komponenti: koja je svrha ako nam ta vrednost ne≈°to ne ka≈æe.
- Mo≈æemo da modeliramo pona≈°anje, ali taj model bi uskoro postao izuzetno nezgodan za kori≈°ƒáenje i opet ne bi uhvatio sve detalje pona≈°anja.
- Re≈°enje je jednostavno: postavimo nekakav problem i merimo koliko je na≈° sistem dobar u njegovom re≈°avanju.

- Ako razmislite o tome, ovo je isto ≈°to se radi studentima:
    - Postavi se problem (ispit)
    - I mere se performanse (ocena).

---

## Problemi

- Naravno, ni ovo nije savr≈°eno.
- Kakav tip problema se izabere, kako se postavi, konfiguri≈°e, i koristi jako utiƒçe na rezultat koji se dobije.
- Grubo gledajuƒái, mo≈æemo da podelimo sva merenja performansi na:
    -Sintetiƒçke
    -Prirodne
- Sintetiƒçki se lako kontroli≈°u i skaliraju.
- Prirodni daju izuzetno verodostojne rezultate‚Äîsamo ≈°to nismo sigurni ≈°ta je to ≈°to mere.
- Primer van HPC: 3DMark vs. framerate.

---

## Malo istorije‚Ä¶

- Prvi `benchmark` ikada je bio za `ENIAC` (prikladno) i bio je raƒçunanje trajektorije ƒëuleta u odnosu na isti proraƒçun koji obavlja balistiƒçki raƒçunar ili ljudsko biƒáe.
- In≈æenjer je, na kraju krajeva, prvobitno bio vojni termin.
- Prvi benchmark u ≈°iroj upotrebi je 'Whetstone' nazvana po gradiƒáu u kome je razvijena.

- `Whetstone benchmark` je bila kolekcija programa koji su stvarali sintetiƒçki problem koji je evaluirao broj instrukcija u datoj sekundi.
- Kasnije, kako su se potrebe menjale, poƒçeo je da ukljuƒçuje i floatingpoint instrukcije, te je merio i `FLOPS`.
---

## Malo istorije‚Ä¶

- Po≈°to je Whetstone specijalizovan za `FLOPS`, napravljen mu je pandan koji meri performanse sa celim brojevima.
- A po≈°to programeri vole malo ≈°ta vi≈°e od igre reƒçima, ovaj pandan se zvao `Dhrystone`.
- Danas Dhrystone je zamenjen sa SPECint paketom.
- I Whetstone i Dhrystone nisu bili namenjeni za HPC, veƒá za evaluaciju procesora.

---

## Linpack

- Najuticajniji benchmark u upotrebi se pojavio 1979 i baziran je na bibliotekama za linearnu algebru poznate kao Linpack (danas zamenjene sa Lapack/BLAS paketom softvera). 
- Linpack meri performanse floating-point operacija, i baziran je na re≈°enju problma oblika:
$$ ùê¥ùë• = ùëè $$
- Ograniƒçenje: 
    - `A` mora da ima nimalo ili jako malo elemenata koji su 0. 
    - `A` je `nxn` matrica
    - `x` je vektor `x0‚Ä¶xn`
    - `b` je vektor `b0‚Ä¶bn`
- Ovo je ekvivalent re≈°avanju sistema od `n` jednaƒçina sa `n` nepoznatih.

---

## Linpack

- Linpack je pro≈°ao kroz iteracije:
    - Prva iteracija je stavljala n na 100 i algoritam koji je koristila je bio serijski.
    - Da bi rezultat bio merodavan, izvorni kod nije smeo da bude modifikovan: jedino parametri kompajliranja.

- Druga iteracija je podigla n na 1000 i:

    -Dozvolila je da se prilagoƒëava izvorni kod faktorizatora i re≈°avaƒça.

    -Dozvolila je, konsekventno, paralelizaciju.

    -Uvela je uslov taƒçnosti nad rezultatima.

- Treƒáa iteracija je HPL.

---

## Highly Parallel Linpack

- *Highly Parallel Linpack* ‚Äî HPL je naznaƒçajniji benchmark svoje vrste.
 - On, pre svega, se koristi da meri `FLOPS` vrednosti za super-raƒçunare i slu≈æi da se lista 500 najbr≈æih odredi.

- HPL je uveo jo≈° znaƒçajnije promene:
    - Samo je problem fiksan
    - Veliƒçina ulaznih podataka mo≈æe da varira.
    - Softver mo≈æe da varira
- Ove promene dozvoljavaju HPLu da se izvr≈°ava na ureƒëajima sa distribuiranom memorijom.

---

## Parametri HPL-a

- Do 20 razliƒçitih zadataka je dozvoljeno, mi specificiramo koliko hoƒáemo da probamo.
- Svaki od zadataka je specificiran preko `n`, tj. broja jednaƒçina i broja nepoznatih.
- Zatim je dozvoljeno do 20 razliƒçitih veliƒçina bloka
    - Bloka? Naƒçin na koji algoritmi ovog tipa rade jeste da rekurzivno razbijaju matricu na pod-matrice. Blok defini≈°e koliki ƒáe biti individualni segment.
    - Gotovo sigurno je u rasponu 32..256 a odreƒëuje se empirijski.

- Zatim se specificira kako se matrica deli po ƒçvorovima
- Dalje, ka≈æe se koliko razliƒçitih konfiguracija procesnih ƒçvorova se koristi za proraƒçun.

---

## Malo vi≈°e o blokovima

.medium[

- Neka je na≈° zadatak da odredimo `C = AB`, gde su `A, B, i C 8x8` matrice.
 - Onda mo≈æemo izdeliti svaku od tih matrica u 4 4x4 pod-matrice kao ≈°to je pokazano desno.
- U praksi, ovo je idealna verzija koja se ƒçesto menja.

- Ideja iza ovog tipa optimizacije jeste poveƒáanje lokalnosti koda.
- Setite se priƒçe o ke≈°u.
- Vratiƒáemo se na ovo kasnije.
]

<p>

$$ \begin{bmatrix}C_{11} & C_{12} \\C_{21} & C_{22} \end{bmatrix}=\begin{bmatrix}A_{11} & A_{12} \\A_{21} & A_{22} \end{bmatrix}\begin{bmatrix}B_{11} & B_{12} \\B_{21} & B_{22} \end{bmatrix} $$
  
$$ C_{11}=A_{11}B_{11}+A_{12}B_{21} \\ C_{12}=A_{11}B_{12}+A_{12}B_{22} \\ C_{21}=A_{21}B_{11}+A_{22}B_{21} \\ C_{22}=A_{21}B_{12}+A_{22}B_{22} \\  $$ 

</p>

---

## Parametri HPL-a

.medium[

- Zatim se specificiraju sve konfiguracije, jedna po jedna, u obliku PxQ

    - Za≈°to tako? Zato ≈°to se matrica bukvalno deli meƒëu ƒçvorovima tako ≈°to se ƒçvorovi zamisle u matriƒçnoj organizaciji, te se svakom ƒçvoru `odseƒçe` odreƒëeni segment matrice.

    - Ovo znaƒçi da ƒáe na≈° proces biti pokrenut, nu≈æno, na PxQ ƒçvorova, ≈°ta god drugo mi specificirali prilikom pokretanja.

    - P i Q se biraju empirijki i zavise od topoloigije na≈°e mre≈æe. Ako je mre≈æa mesh-ovana tako da imamo vi≈°e linija za svaki raƒçunar onda je najbolje da je P blizu Q a Q malo veƒáe od P. U sluƒçaju prostog Ethernet-a najbolje je biti pljosnat: Za nas 1x4 mo≈æda 2x2.

- Linija 13 defini≈°e stepen taƒçnosti do kog raƒçunamo. 16.0 je tipiƒçna vrednost, mada se ona mo≈æe poveƒáavati i do stotina hiljada. Ovo je zbog nepreciznosti poreƒëenja floating point brojeva, prvo, i skale koja se koristi za test.

- Ostatak slu≈æi za pode≈°avanje algoritma o ƒçemu vi≈°e kada budemo radili linearnu algebru u HPC okru≈æenju.
]

---

##Rezultati HPL-a

- HPL nam omoguƒáava da odredimo veƒái broj vrednosti i od njih nas zanima:
    - `Rpeak` ‚Äî Broj FLOPSa koji smo izraƒçunali da je teoretski moguƒá
    - `Rmax + Nmax` ‚Äî Ovo je veliƒçina ulaznog skupa (Nmax) za koju je ostvaren najveƒái stvarni broj FLOPSa (Rmax).
    - `N1/2` ‚Äî Veliƒçina ulaznog skupa za koju je ostvareno pola maksimalne ostvarene performanse.

---

## Osobine dobrog benchmark-a

- Da li je HPL dobar benchmark? 
    - ≈†ta znaƒçi biti `dobar` u ovom kontekstu?
- Bazirano na iskustvu mo≈æe se reƒái da dobar benchmark ima sledeƒáe osobine:
    - `Realizam`. Mora simulirati tip rada na koji se nailazi u praksi.
    - `Univerzalnost`. Adekvatno radi na velikom broju arhitektura.
    - `Popularnost`. Dosta korisnika znaƒçi da imamo dosta uporedivih rezultata.
    - `Kompaktnost`. Mali broj linija koda znaƒçi manje ≈°uma.
    - `Ureƒëenost`. Postoje jasna pravila oko toga kako se dobijaju merodavni rezultati 
    - `Standardizovanost`. Upotreba standardnih tehnologija.

---

## HPC Challenge

- `HPC Challenge Benchmark Suite` je malo op≈°irnija alternativa HPL-u.
- Sa pozitivne strane: meri mnogo vi≈°e stvari.

- Sa negativne strane: ne proizvodi jednu stvar, nego vi≈°e, ≈°to ƒçini samerljivost kompleksnijom. 
- ƒåak i da primenimo matematiƒçku koncepciju razdaljine u vi≈°edimenzionalnom prostoru, i dalje moramo da ustanovimo zajedniƒçku skalu plus da odredimo funkciju metrike. 
- Kao rezultat moguƒáe je formulisati beskonaƒçno mnogo samerljivosti ≈°to nas ostavlja sa ogromnim koordinacionim problemom.
    
---

## HPC Challenge

.medium[

- HPCC se sastoji od sledeƒáih mera:
    - `DGEMM`
        - Mnozenje matrica* matrica, slicno HPLu nameni 
    - `STREAM`
        - Sinteticki problem koji meri dugorocnu moc memorije 
    - `PTRANS`
        - Paralelizovano transponovanje matrica
    - `RandomAccess`
        - Nasumiƒçno poostavlja nove celobrojne vrednosti u nasumiƒçne delove memorije. 
        - Meri se u *Giga Updates Per Second: GUPS*. 
    - `FFT `
        - Jednodimenzionalna kompleksna diskretizovana Furjeova transformacija
    - `B_eff`
        - Ka≈°njenje i protoƒçna moƒá za razliƒçite obrasce komunikacije
]

---

## ≈†ta odlikuje HPCC?

- Fokus na memoriju.
- Distribuirani sistemi su izuzetno osetljivi na zadatke koji zahtevaju slobodan tok podataka kroz ceo sistem.

- HPCC stress-testira ba≈° ovaj deo koji konvencionalniji HPL uglavnom ignori≈°e.

- Ovo ne ƒçini HPL-lo≈°im niti HPCC dobrim.
    - ≈†to?  
- Namena raƒçunara diktira ≈°ta ≈æelimo da merimo.

---

## High Performance Conjugate Gradients

- `HPCG` odr≈æavaju isti ljudi kao i HPL i slu≈æi da meri stvari koje HPL ne dodiruje.
- Problem koji HPC re≈°ava je sasvim isti kao onaj koji re≈°ava HPL.
- Pa koja je onda razlika?

---

## HPCG

- I HPCG meri performanse floating-point operacija, i baziran je na re≈°enju problma oblika:
$$ ùê¥ùë• = ùëè $$
- Ograniƒçenje: 
    - A mora da ima veƒáinu elemenata koji su jednaki 0.
    - A je nxn matrica
    -x je vektor x0‚Ä¶xn
    -b je vektor b0‚Ä¶bn
- Ovo je ekvivalent re≈°avanju sistema od n jednaƒçina sa n nepoznatih.

---

## HPCG

- To ≈°to je A retka matrica menja tehnologiju za re≈°avanje potpuno.
- Glavna je stvar to ≈°to ima puno komunikacije izmeƒëu ƒçvorova i puno redukcionih operacija o ƒçemu vi≈°e uskoro.
- Ovo menja rezultate jako, jako, jako puno.
- Koliko puno?

- Razlika izmeƒëu ostvarenih performansi za HPL i HPCG je 15000%.
    - Proseƒçno. Vrhunski sistemi ostvaruju na HPCG oko 1% onoga ≈°to ostvaruju na HPL.
    - Postoje izuzeci, ali ƒçak i ≈°ampion, tkzv. K-raƒçunar ostvaruje samo 5.3%.

---
    
## NAS Parallel Benchmarks

- NPB je sliƒçan HPCC-u u tome ≈°to predstavlja kombinaciju tipiƒçnih problema.
- Specifiƒçno predstavlja 8 tipiƒçnih problema koji su poznati pod svojim dvoslovnim skraƒáenicama.

---

### NPB Skraƒáenica

.center-table.small[
| **Skraƒáenica** |         **Znaƒçenje**        |                             **Obja≈°njenje**                             |
|:--------------:|:---------------------------:|:-----------------------------------------------------------------------:|
|       IS       |         Integer Sort        | Sortiranje celih brojeva. Testira celobrojnu brzinu i performanse mre≈æe |
|       EP       |    Embarassingly Parallel   |                     Testira blizu-maksimlanu brzinu.                    |
|       CG       |      Conjugate Gradient     |            Radi raƒçun karakteristiƒçne vrednosti retke matrice           |
|       MG       |          MultiGrid          |    Integracija diferencijalne jednaƒçine kroz metodu vi≈°e rezolucija.    |
|       FT       |       Discrete 3D FFT       | Integracija 3D parcijalne diferencijalne jednaƒçine po vremenu kroz FFT. |
|       BT       |   Block Tridiagonal Solver  |            Re≈°avanje sistema jednaƒçina trodijagonalnog  tipa.           |
|       SP       | Scalar Pentadiagonal Solver |           Re≈°avanje sistema jednaƒçina pentadijagonalnog tipa.           |
|       LU       |    LU Gauss-Seidel solver   |                        Isto ≈°to i HPL, efektivno.                       |

]

---

## Graph500

- Do ovog trenutka,postoji odreƒáena tendencija u svim ovim merama:
    -Diferencijalne jednaƒçine 
    - Sistemi linearnih jednaƒçina raznih tipova.
    - Baziƒçne celobrojne operacije.
- Ovo su primeri problema simulacija za graƒëevinu,masinstva,i fiziƒçku, opste govoreƒái.
- To je lepo,ali nisu svi problemi ovakvi. 
- Veliki skupovi problema se predstavljaju kroz operacije nad grafovima. 
---

## Graph500    

- Graph500 ne samo da odgovara tom domenu nego radi i u ≈°irem kontekstu‚Äîsimulira aplikacije sa intenzivnim pristupom podacima.
- Graph500 defini≈°e, u stvari, 3 benchmark-a
    - Graph500 1 ‚Äî konkurentna pretraga
    - Graph500 2 ‚Äî Najkraƒáa putanja
    - Graph500 3 ‚Äî Najveƒái nezavisni skup (tj. najveƒái skup ƒçvorova grafa takvih da nikoja dva nisu povezana)
- Samo Graph500 1 je implementiran i to preko Breadth First Search-a grafa, tako ≈°to za 64 jedinstvena poƒçetna ƒçvora u tom grafu naƒëe sve ƒçvorove do kojih se mo≈æe doƒái.
- Graf je cikliƒçan, bez te≈æina, i neusmeren.
---

## Graph500

- Graph500 je implementiran sa istovremenim `OpenMP`  i `OpenMPI` paralelizmom ≈°to odgovara modernim sistemima.
- Rezultate ne vraƒáa u FLOPS-ima u TEPS-ima (Traversed Edges Per Second)
- Poreƒëenje izmeƒëu `FLOPS` i TEPS je te≈°ko ali ima jedna druga stvar koja je jako bitna:
    - U FLOPS-ima raƒçunari nastavljaju svoj eksponencijalni rast.
    - U TEPS-ima performanse stagniraju.
    - Arhitekture deljene memorije su mnogo bolje (u kontekstu TEPS-pojezgru) od arhitektura distribuirane memorije.
    - Ovo mo≈æete ƒçitati kao "breakthrough wanted" znak.

---
## Miniaplikacije

- Sve do sada, svi ovi benchmark-ovi rade sa sintentiƒçkim podacima koji poku≈°avaju da simuliraju ≈°ta bi stvarna aplikativna primena postigla.
- Mogu se meriti rezultati punih aplikacija, naravno, ali su oni tako specifiƒçni da nisu osobito korisni: nisu univerzalni i nisu sveprisutni.
- Poku≈°aj da se odradi kvadratura kruga ovde jesu miniaplikacije: pojednostavljeni ali realni poslovi.
- Ovoga se dotiƒçemo kada budemo radili domenski-specifiƒçne biblioteke mnogo, mnogo kasnije.

---

layout: false
name: tehnikeHPC
class: center, middle, inverse

# Tehnike upravljanja HPC sistemima

## SLURM, PBS, i pode≈°avanje za performantnost 

---
layout: true

.section[[Tehnike upravljanja HPC sistemima](#sadrzaj)]

---

## ƒåime to moramo da upravljamo?

- Nema nekakve magije u HPC klasteru.
- To su stvarno samo Linux raƒçunari u mre≈æi.
- Brzi raƒçunari povezani brzom mre≈æom, istina, ali to je sve.
- `OpenMP`  programi su samo multi-threaded programi na jednom raƒçunaru. To se pokreƒáe na isti naƒçin kao i svaki drugi program‚Äîto ste probali.
- `OpenMPI` tehnologija je neophodna da se ukljuƒçi vi≈°e ƒçvorova.
- Tu se programi moraju pokretati posebnom komandom i to na svakom ƒçvoru.
- Kada pokretati koliko programa i koje im resurse dodeliti‚Ä¶ to je dosta posla da se radi rukom ƒçak i na malom klasteru.

---

## Upravljanje HPC klasterima

- Re≈°enje je specijalizovan softver koji slu≈æi da upravlja ƒçvorovima i pokreƒáe stvari kad mi hoƒáemo kako mi hoƒáemo.
- Softver se tipiƒçno sastoji od servisa koji rade na raznim delovima HPC klastera i komandama koje komuniciraju sa tim servisima.

---

## Resursi koje kontroli≈°e upravljaƒçki softver

.medium[
- ƒåvorovi za raƒçunanje.
    - Osnovna stvar koja se kontroli≈°e. Na svaki raƒçunar se moraju slati podaci, pokretati procesi, gasiti procesi, itd.
- Procesorska jezgra.
    - U okviru jednog raƒçunara je neophodno alocirati individualna jezgra i to na drugaƒçiji naƒçin buduƒái da su njihove karakteristike drugaƒçije.
- Raƒçunarske veze 
    - Mre≈æa u klasterima mo≈æe biti jako kompleksna i heterogena. Upravljaƒçki softver se stara i da to radi kako treba
- Eksterna memorija
    - Upravljaƒçki softver se stara da je eksterna memorija dostupna i maksimalno performantna.
- I/O. 
    - Komunikacija sa spoljnim svetom ne mo≈æe biti ad hoc.
- Akceleratori
    - U heterogenim sistemima akceleratori proraƒçuna (najƒçe≈°ƒáe ali ne uvek GPU-ovi) su odvojen resurs koji se posebno alocira i posebno programira.
]

---
## Kljuƒçni koncepti upravljaƒçkog softvera

- Glavni koncept su zadaci (*jobs*) koji predstavljaju jednu celinu koju korisnik hoƒáe da pokrene.
- Zadaci mogu biti:
    - Interaktivni (*interactive*). ‚Äî Postoji ljudski operator.
    - Automatski (*batch*). ‚Äî Nema operatora. Najƒçe≈°ƒáe zadaci su ovakvi.

- Iako mogu biti monolitni, tipiƒçno zadaci se sastoje od vi≈°e koraka (*task* odn. *step*). Ono ≈°to karakteri≈°e korake jeste da mogu imati potpuno razliƒçite zahteve nad resursima.

- Zadaci idu u redove (*queue*) izvr≈°avanja i koji od zadataka koji stoje u redu se izvr≈°ava kada odreƒëuje proces reda izvr≈°avanja (*scheduling*).

---

## Faktori koji utiƒçu na proces reda izvr≈°avanja

.medium[

- Dostupnost neophodnih resursa.
    - Ako nema gde da se ne≈°to izvr≈°i onda se sigurno neƒáe izvr≈°iti.
- Prioritet.
    - U zavisnosti ko zahteva izvr≈°avanje i ≈°ta je priroda posla mo≈æe da doƒëe na red ranije ili kasnije.
- Korisniƒçki bud≈æet resursa
    - Svaki korisnik mo≈æe imati fiksnu koliƒçinu resursa koju sme da anga≈æuje.
- Ograniƒçenje broja zadataka.
    - Svaki korisnik mo≈æe imati ograniƒçeni broj zadataka koji sme zatra≈æiti u nekom trenutku.
- Procenjeno vreme izvr≈°avanja
    - Kada zadajemo zadatak uvek navodimo koliko vremena tra≈æimo.
]

---

## Faktori koji utiƒçu na proces reda izvr≈°avanja

.medium[

- Ostvareno vreme izvr≈°avanja.
    - Zadatak mo≈æe biti prekinut u zavisnosti od toga koliko dugo se veƒá izvr≈°ava.
- Uslovljenost zadatka.
    - Zadaci mogu zavisiti od zavr≈°etka drugih zadataka.
- Dogaƒëaji
    - Neki zadaci se samo de≈°avaju kada se na nivou celog sistema desi nekakav dogaƒëaj.
- Dostupnost operatora.
    - Interaktivni zadaci su samo moguƒái ako ima neko fiziƒçki prisutan za terminalom.
- Dostupnost licence.
    - Ponekad na≈° kod zahteva licence koje se prodaju po jezgru. To znaƒçi da je to samo jo≈° jedan resurs koji treba alocirati.
]

---

## Popularni alati za upravljanje HPC sistemima.

.medium[

- *Simple Linux Utility for Resource Management (SLURM)* ‚Äî moƒáno, pro≈°irivo FOSS re≈°enje.
- *Portable Batch System* ‚Äî Alternativa koja je nekad bila komercijalan kod, a sada postoji u FOSS varijanti.
- *OpenLava* ‚Äî Jo≈° jedna alternativa.
- *Moab Cluster Suite* ‚Äî Komercijalan softver fokusiran na ekstremnu skalabilnost.
- *LoadLeveler* ‚Äî IBM proizvod prvobitno namenjen za AIX.
- *Univa Grid Engine ‚Äî Oracle/Sun* re≈°enje za heterogene raƒçunarske sisteme.
- *HTCondor ‚Äî FOSS* re≈°enje za high-throughput coarse-grained HPC.
- *OAR* ‚Äî Re≈°enje fokusirano oko data-intensive problema
- *Hadoop Yet Another Resource Negotiator* ‚Äî Re≈°enje za map-reduce.

]

---

layout: false
name: slurm
class: center, middle, inverse

# SLURM
## uvod

---
layout: true

.section[[SLURM](#sadrzaj)]

---
## ?

![:scale 90%](img/Slurm_Soda.jpg)

---

## Pre ƒáe biti ovaj‚Ä¶

![:scale 60%](img/Slurm_logo.svg.png)

---

## Za≈°to fokus na alat?

- Uop≈°teno govoreƒái, nije svrha ovakvog kursa da vam se ƒçitaju uputstva odnosno man stranice.
- No, ipak ƒáe tu i tamo biti ba≈° toga.
- ≈†to?
- Pa ovde je razlog jednostavan: kroz razumevanje parametara i komandi `SLURM` sistema imamo priliku i da nauƒçimo:
    - ≈†ta su faktori u upravljanju klasterima?
- Kako se pa≈æljivim upravljanjem resursima podi≈æu performanse sistema i naroƒçito performanse po utro≈°enom novcu?
- Kao bonus, takoƒëe mo≈æete da nauƒçite i kako se `SLURM` mo≈æe koristiti ≈°to ƒáe vam biti od koristi.

---

## Za≈°to je `SLURM` odliƒçan?

- Jednostavan
- Gotovo beskonaƒçno skalabilan:
    - `SLURM` se koristi, na primer, na TaihuLight ma≈°ini sa nekih 40 000 CPU-ova i 10 000 000 jezgara.
    - Od najbr≈æih 10 raƒçunara oko 5 koristi `SLURM`.
    - 1000 zadataka se mo≈æe zakazati po sekundi a 500 izvr≈°iti.
- Podr≈æava heterogene tehnologije

---

## Arhitektura `SLURM` sistema

![:scale 80%](img/arh.png)

---

## Grupisanje elemenata upravljanja u `SLURM` sistemima

- ƒåvorovi se mogu ubacivati u particije.
- Particije mogu biti:
    - Disjunktne
    - Preklapajuƒáe
- Particije odgovaraju redovima izvr≈°avanja
- Zadaci se grupi≈°u u nizove zadataka koje odlikuju isti parametri izvr≈°avanja.

---

## Raspored izvr≈°avanja (*scheduling*) u `SLURM` sistemima

- Ovo je sve pro≈°irivo, ali grubo govoreƒái imamo tri razliƒçita pristupa koja rade istovremeno.
- Raspored izvr≈°avanja voƒëen dogaƒëajima.
- Ukupni raspored izvr≈°avanja.
- Unazad propagirajuƒái raspored izvr≈°avanja.

---

## Raspored izvr≈°avanja voƒëen dogaƒëaijma

- Ovo je najjednostavniji naƒçin da se rasporede zadaci.
- Takoƒëe je najbr≈æi.
- Kada god se promeni status sistema (neki ƒçvor se ukljuƒçi, neki zadatak se zavr≈°i, itd.) pokrene se ovaj algoritam.
- Algoritam uzme odreƒëeni broj zadataka sa prednjeg kraja reda i analizira ih u skladu sa ranije pomenutim faktorima.
- Sve ≈°to je nazad u redu se ignori≈°e dok ne stigne na prednji kraj.
- Ovo je brzo ali mo≈æe dovesti do ne ba≈° efikasne raspodele.

---

## Ukupni raspored izvr≈°avanja.

- Ukupni algoritam se pokreƒáe samo povremeno zato ≈°to mora da posmatra sve zadatke koji su zakazani.
- Ovo ga ƒçini sporim.
- Balans izmeƒëu efikasnijeg sistema rasporeda zadataka i usporenja usled tro≈°kova sistema se posti≈æe povremenim pokretanjem koje spreƒçava da se nisko-efikasne situacije u rasporedu propagiraju.

---

## Unazad propagirajuƒái raspored izvr≈°avanja.

- Naroƒçit primer ne-efikasnosti jeste kada imamo zadatke niskog prioriteta a velikih zahteva.
- Jasno je da oni moraju da ƒçekaju, ali ako stalno sti≈æu prioritetniji poslovi, ƒçekaƒáe zauvek.
- Unazad propagirajuƒái sistem za raspored analizira oƒçekivano vreme kada svi poslovi treba da poƒçnu, koliko treba da traju, i do kada se izvr≈°avaju i tra≈æi vremena gde se izvr≈°avanje nisko-prioritetnih poslova mo≈æe udenuti tako da ne izazove ka≈°njenja u op≈°tem rasporedu sistema.

---
## Napredni koncepti u sistemu rasporeda izvr≈°avanja SLURM

- Gang scheduling
- Preemption
- Generic resource allocation
- Trackable resources.
- Elastic computing.
- High-throughput computing.

---

## Gang scheduling

- Mehanizam gde poslovi koji imaju sliƒçne prohteve za resursima dele iste resurse tako ≈°to jedni drugima predaju ekskluzivnu kontrolu.
- Najbolje radi ako imamo particiju ƒçija konfiguracija odgovara prohtevima te klase poslova.
- Particije ba≈° za to i slu≈æe.
- Mehanizam odredi du≈æinu alokacije (koja se zove `timeslice` i konfigurabilna je) i kada god proƒëe jedan timeslice suspenduje tekuƒái zadatak i aktivira suspendovan zadatak iste klase zahteva koji najdu≈æe ƒçeka u suspendovanom stanju.

- Ovo jako liƒçi na to kako se radi mulit-tasking na raƒçunarima sa jednom niti izvr≈°avanja.

---

## Preemption

- Mehanizam gde zadaci ni≈æeg prioriteta mogu da se zaustave kada se alociraju zadaci vi≈°eg prioriteta kojima trebaju resursi koji su veƒá u upotrebi.
- Radi isto kao gang scheduling sa tim da:

    - Iniciranje algoritma ne radi proticanje vremena, no alokacija resursa za nov zadatak.
    - Promena ko se izvr≈°ava nije u round-robin sistemu, no je voƒëena prioritetom.

---

## Generic resources

- Odnosi se na posebne hardverske module koje mo≈æe da ima nekakav ƒçvor i koji ga, stoga, ƒçine osobenim.
- ≈†ta je to?
    -GPU
    - MIC
    - A, u buduƒánosti?
        - FPGA
        - Kripto-modul
        - Kvantni raƒçunar
        - Kvantni simulator kaljenja
        - Neuro-akcelerator

---

## Generic resources

- ≈†ta god da je generiƒçki resurs, mi mo≈æemo da zahtevamo ƒçvor koji ga ima i sistem za raspored izvr≈°avanja ƒáe voditi raƒçuna o tom zahtevu.

- Menad≈æment GRES-ovima nije ba≈° savr≈°en: suspendovanje zadataka trenutno ne oslobaƒëa GRES-ove zato ≈°to se postavlja pitanje ≈°ta GRES mo≈æe da saƒçuva a ≈°ta ne i ≈°ta je "bezbedno poƒçetno stanje" za GRES.
- Praktiƒçno, za nas, readback iz GPU memorije je‚Ä¶ pipava stvar.

---

## Trackable resources.

- `SLURM` ima mehanizam koji omoguƒáava da se pa≈æljivo prati i bele≈æi upotreba raznih resursa (TRES-ova):
    - CPU-ova
    - Bafera
    - Energije
    - GRES-ova
    - Licenci
    - Memorija
    - ƒåvorova
- Ovo omoguƒáava dijagnostiku i, tu≈æno je reƒái, naplatu.

---

## Elastic computing.

- Mehanizam kojim sistem za upravljanje resursima mo≈æe da analizira trenutne prohteve sistema i menja veliƒçinu sistema na adekvatan naƒçin.

- Sistem se mo≈æe smanjiti tako ≈°to se ƒçvorovi za kojima nema potrebe automatski iskljuƒçe.
- Kako se poveƒáava? Normalno nikako, ali ako je u pitanju cloudbaziran sistem, moguƒáe je raditi automatski provisioninig jo≈° resursa po potrebi, ili barem dok Amazonu ne ponestane.
- Naravno to ko≈°ta stoga ovaj deo mora biti konfigurisan izuzetno pa≈æljivo.

---

## High-throughput computing

- HTC je poseban scenario u okviru HPC problema gde je najprirodniji naƒçin da se problem opi≈°e jeste preko jako velikog broja slabo povezanih zadataka.
- Idealan primer jeste renderovanje: svaki frejm je za sebe, a potencijalno ≈æelimo jako mnogo frejmova.
- Film od 90 minuta, na kraju krajeva, zahteva da renderujemo 129600 fejmova.
- Stoga `SLURM` ima posebnu logiku za slabo povezane mnogobrojne poslove koja dozvoljava da se pokrene po 500 takvih poslova u sekundi.

---

## Komanda srun
- Najosnovnija komanda `SLURM` sistema je srun
- Op≈°ta sintaksa komande je: `srun [<options>] <executable>[<arguments>]`
- Znaƒçenje je da se sa odreƒëenim opcijama pokreƒáe u okviru klastera komanda `executable` kao zadatak
- Ako se srun pokrene u okviru veƒá pokrenutog zadatka defini≈°e ne nov zadatak veƒá nov korak.
- Kompleksnost ove naizgled jednostavne komande jeste u opcijama koje su ƒçesto kljuƒçne za dobro izvr≈°avanje

---

## -N opcija

- Opcija ‚ÄìN odreƒëuje broj ƒçvorova koji se tra≈æi za komandu
- Mora imati makar jedan broj posle sebe, taj broj je minimalan broj ƒçvorova koji tra≈æimo.
- Mo≈æe i da ima dva broja u obliku `‚ÄìN<n1>-<n2>`
    - n1 je minimalni broj ƒçvorova
    - n2 je maksimalni broj ƒçvorova

---

## -n i ‚Äìc opcije

- -n opcija slu≈æi da se podesi broj procesa koji ƒáe se pokrenuti
- Svaki proces je jedna instanca na≈°e aplikacije
- Da bi ovo imalo smisla nadamo se da na≈°a aplikacija zna kako da se pona≈°a u takvom okru≈æenju.
- Podrazumevano je da 1 proces dobije 1 ƒçvor
- Ovo menja ‚Äìc opcija ona odreƒëuje koliko ƒáe jezgara biti alocirano po svakom procesu. To omoguƒáava da imamo vi≈°estruke ali i vi≈°enitne procese, tj. `OpenMPI` + OpenMP.
- Ako bi zvr≈°ili srun ‚Äìn4 ‚Äìc8 app0 onda bi pokrenuli app0 ƒçetiri puta i to tako da svako pokretanje zauzme barem osam jezgara. To znaƒçi da ako imamo sistem sa po 16 jezgara po ƒçvoru zauzeƒáemo 2 ƒçvora.

---

## --mincpus opcija

- Mo≈æemo komplikovati stvar tako ≈°to koristimo ovu opciju, jednu od mnogih koja postavlja ograniƒçenje na tip ƒçvora koji mo≈æe da se koristi
- Sintaksa je, na primer, --mincpus=32 ≈°to, kao opcija, bi reklo da se na≈° program mo≈æe izvr≈°iti iskljuƒçivo na ƒçvorovima koji imaju bar 32 procesora/jezgra/niti (terminologija je malo labava, ali se misli na 32 paralelna izvr≈°avanja).
- Ako bi komandu sa pro≈°log slajda promenili da bude srun ‚Äìn4 ‚Äìc8 ‚Äì mincpus=32 app0 pokrenuli bi 4 procesa app0, svaki bi dobio 8 jezgara i svi bi bili na jednom ƒçvoru sa 32 jezgra pod uslovom da takav postoji.

---

## Labava terminologija

- Buduƒái da je ponekad nejasno ≈°ta se misli pod CPU ovih dana, `SLURM` uvodi jasnu terminologiju i komande koje manipuli≈°u tim jasnim terminima u svrhu uvoƒëenja ograniƒçenja
- Po `SLURM` terminologiji:
    - Core je fiziƒçko jezgro kojih je tipiƒçno vi≈°e po ƒçipu
    - Socket je fiziƒçki ƒçip utaknut u ZIF utiƒçnicu na nekom raƒçunaru
    - Thread je sistemska nit izvr≈°avanja
- Opcije su:
    - `--cores-per-socket=<vrednost0>`
    - `--sockets-per-node=<vrednost1>`
    - `--threads-per-core=<vrednost2>`

- Ovo se mo≈æe napisati i br≈æe ovako:
    - `-B<vrednost1>[:<vrednost0>[:<vrednost2>]]`

---

## -m opcija

- Ova opcija pode≈°ava kako se procesi rasporeƒëuju izmeƒëu ƒçvorova/procesora itd.
- Ima izuzetnog uticaja na performanse i `taƒçne` vrednosti jako zavise od toga kako na≈° kod radi i kako funkcioni≈°e lokalnost.
- Sintaksa je:
    - `-m<nodeDist>[:<socketDist>[:<coreDist>]][,{Pack,NoPack}]`

---

## A kako radi nodeDist?

- `*` ‚Äî podrazumevana opcija, najƒçe≈°ƒáe block
- `block` ‚Äî procesi ƒáe biti dodeljeni redom ƒçvoru dok ne ponestane resursa, te ƒáe onda biti slati dalje.
- `bcyclic` ‚Äî procesi se dele po ƒçvorovima tako ≈°to se da jedan prvoj, pa onda drugi drugoj i tako dok ne ponestane moguƒáih ƒçvorova a onda se poƒçinje od prvog, opet.
- `plane=<n>` ‚Äî stavi n procesa na jedan ƒçvor i onda ide dalje dabstavi n procesa na drugi ƒçvor i tako.
- `arbitrary` ‚Äî ƒçita pona≈°anje iz sistemske promenljive

---

## coreDist i socketDist

- Rade isto kao nodeDist samo ≈°to:
- Podrazumevani re≈æim je cyclic
- Cyclic ƒáe grupisati zadatke po jezgru/procesoru
- Fcyclic je neophodan da bi se zadaci meƒëu njima rasporeƒëivali po 100% round-robin pristupu

---

## Pack i NoPack

- Pack i NoPack su hintovi sistemu koji odreƒëuju kako se sistem pona≈°a kada ima `izbor`
- Pack ka≈æe da se procesi rasporede tako da maksimalno popune ƒçvor
- NoPack ka≈æe da se procesi rasporede tako da podela po alociranim resursima bude maksimalno fer, tj. ravnomerna

---

## -w opcija

- Dobija kao parametar ili listu ƒçvorova koje hoƒáemo da alociramo poimence ili putanju do fajla gde se ta lista ƒçvorova nalazi
- Ima vi≈°e smisla u malim klasterima gde ponekad znamo taƒçno ≈°ta hoƒáemo
- U sistemima sa 40 000 procesora‚Ä¶ ima manje smisla.

---

## Alokacija memorije

- Mo≈æemo tra≈æiti memoriju po ƒçvoru sa komandom `‚Äìmem=<m>` gde je <m> broj megabajta koji se alocira za zadatak.
- Mo≈æemo i tra≈æiti memoriju tako ≈°to specificiramo koliko nam treba memorije po procesoru koristeƒái `‚Äìmem-per-cpu =<m>` na isti naƒçin.

---

## Automatsko pode≈°avanje

- Mo≈æemo zatra≈æiti pomoƒá sistema tako ≈°to sugeri≈°emo kakav je tip problema sa kojim se suoƒçavamo koristeƒái opciju `--hint=<type>` gde je tip jedno od:
    - `compute_bound` ‚Äî algoritmu je usko grlo proraƒçun, tako da se alociraju sva jezgra u svakom ƒçipu sa po jednom niti po jezgru.
    - `memory_bound` ‚Äî algoritmu je usko grlo memorija, tako da se koristi po jedno jezgro u svakom ƒçipu i jedna nit po jezgru
    - `multithread` ‚Äî koristi vi≈°e niti po jezgru
    - `nomultithread` ‚Äî nemoj koristiti vi≈°e niti po jezgru

---

## Ograniƒçavanje broja procesa

- Mo≈æemo podesiti da se nad jednim ƒçvorom, ƒçipom, ili jezgrom izvr≈°ava ne vi≈°e od neke vrednosti n procesa kroz sintaksu:
    - `--ntasks-per-core=<n>`
    - `--ntasks-per-socket=<n>`
    - `--ntasks-per-node=<n>`

- `--ntasks-per-node=<n>` je naroƒçito va≈æna opcija jer ako se tu stavi 1, to je idealno za aplikacije koje koriste `OpenMP`  kombinovan sa `OpenMPI` buduƒái da svaki ƒçvor dobije jedan proces koji onda koristi niti za paralelizam unutar ƒçvora.

---

## Ekskluzivnost

- Opcija `--exclusive` nam omoguƒáava da zahtevamo da ne delimo ƒçvorove sa drugim zadacima
- Ovo mo≈æe biti bitno ako znamo da ƒáe rezultujuƒáe zagu≈°enje ugroziti performanse i na≈°eg posla i tuƒëeg

---

## GRES ograniƒçenje
- `--gres` opcija ima sintaksu `--gres=<resource_list>` gde je sintaksa za `resource list` takva da se sastoji od zarezima odvojene liste resursa, a resurs ima sintaksu koja je: `<name>[[:<type>]:count]`
- Recimo srun -N16 `--gres=gpu:kepler:2 app0` ƒáe startovati app0 na 16 ƒçvorova koji moraju imati (i za upotrebu ove aplikacije alocirati) po 2 GPU-a tipa Kepler.

---

## -C opcija

- Mo≈æemo anotirati ƒçvorove sa osobinama.
- -C opcija nam kasnije dozvoljava da tra≈æimo ƒçvor sa ba≈° tim, anotiranim osobinama.
- Specifikacija za -C se pi≈°e odamh posle u znacima navoda i sastoji se od imena opcija razdvojenih sa & i | kao AND i OR operatorima.
- Takoƒëe ima posebna sintaksa oblika `srun -N8 -C '[rack1|rack3|rack5]' app0`
- Ovo pokreƒáe app0 na osam ƒçvorova koji moraju da budu ili rack1 ili rack3 ili rack5.

---

## -t opcija

- Koliko vremena u satima:minutima:sekundama ≈æelimo da radi na≈° softver.
- Kada to vreme istekne dobijamo `TERM` signal
- Ako ne uradimo ne≈°to sa tim TERM-om dobijemo uskoro i `KILL` signal

---

## Signali

- `TERM`? `KILL`?
- Unix ima svoju filozofiju komunikacije izmeƒëu procesa
- Jedan od glavnih jesu signali: softverski prekidi koji oznaƒçavaju da se u sistemu desio nekakav dogaƒëaj.
- Ponekad ih generi≈°u drugi procesi, ponekad sam operativni sistem, a ponekad korisnik direktno.
- Signali imaju razliƒçito znaƒçenje
- Mo≈æe se dobiti kompletna lista iz operativnog sistema

---
## Signali

```console
mt@mt:~/HPC$ kill -l
 1) SIGHUP	 2) SIGINT	 3) SIGQUIT	 4) SIGILL	 5) SIGTRAP
 6) SIGABRT	 7) SIGBUS	 8) SIGFPE	 9) SIGKILL	10) SIGUSR1
11) SIGSEGV	12) SIGUSR2	13) SIGPIPE	14) SIGALRM	15) SIGTERM
16) SIGSTKFLT	17) SIGCHLD	18) SIGCONT	19) SIGSTOP	20) SIGTSTP
21) SIGTTIN	22) SIGTTOU	23) SIGURG	24) SIGXCPU	25) SIGXFSZ
26) SIGVTALRM	27) SIGPROF	28) SIGWINCH	29) SIGIO	30) SIGPWR
31) SIGSYS	34) SIGRTMIN	35) SIGRTMIN+1	36) SIGRTMIN+2	37) SIGRTMIN+3
38) SIGRTMIN+4	39) SIGRTMIN+5	40) SIGRTMIN+6	41) SIGRTMIN+7	42) SIGRTMIN+8
43) SIGRTMIN+9	44) SIGRTMIN+10	45) SIGRTMIN+11	46) SIGRTMIN+12	47) SIGRTMIN+13
48) SIGRTMIN+14	49) SIGRTMIN+15	50) SIGRTMAX-14	51) SIGRTMAX-13	52) SIGRTMAX-12
53) SIGRTMAX-11	54) SIGRTMAX-10	55) SIGRTMAX-9	56) SIGRTMAX-8	57) SIGRTMAX-7
58) SIGRTMAX-6	59) SIGRTMAX-5	60) SIGRTMAX-4	61) SIGRTMAX-3	62) SIGRTMAX-2
63) SIGRTMAX-1	64) SIGRTMAX	
```

---

## Signali

.medium[
- Reakcija na signale
- Svaki tip signala ima jednu podrazumevanu akciju iz sledeƒáeg skupa:
    - `Term`
        - Proces koji dobija signal se terminira
    - `Ign`
        - Proces koji dobija signal ga ignori≈°e.
    - `Core`
        - Podrazumevana akcija jeste da se terminira proces i da se u fajl izbaci sva memorija procesa.
    - `Stop`
        - Proces se pauzira.
    - `Cont`
        - Proces se nastavi ako je pauziran.
]

---

## Namena signala

.center-table.small[

| **Ime signala** | **Broj signala** | **Reakcija** |                                 **Svrha**                                |
|:---------------:|:----------------:|:------------:|:------------------------------------------------------------------------:|
|      SIGHUP     |         1        |     Term     | Prekinuta veza na kontrolnom terminalu, odn. smrt kontroli≈°uƒáeg procesa. |
|      SIGINT     |         2        |     Term     |                                 Kontrol-C                                |
|     SIGQUIT     |         3        |     Core     |                             Quit sa tastature                            |
|      SIGILL     |         4        |     Core     |                           Ilegalna instrukcija                           |
|     SIGABRT     |         6        |     Core     |                               Abort signal                               |
|      SIGFPE     |         8        |     Core     |                           Floating-point gre≈°ka                          |
|     SIGKILL     |         9        |     Term     |                             Ubijanje procesa                             |
|     SIGSEGV     |        11        |     Core     |                             Memorijska gre≈°ka                            |
|     SIGPIPE     |        13        |     Term     |                    Gre≈°ka u pisanju u dvosmerni bafer                    |
|     SIGALRM     |        14        |     Term     |                                  Tajmer                                  |

]

---

## Namena signala

.center-table.small[

| **Ime signala** | **Broj signala** | **Reakcija** |                    **Svrha**                    |
|:---------------:|:----------------:|:------------:|:-----------------------------------------------:|
|     SIGTERM     |        15        |     Term     |              Signal za terminaciju              |
|     SIGUSR1     |        10        |     Term     |             Rezervisan za korisnika.            |
|     SIGUSR2     |        12        |     Term     |             Rezervisan za korisnika.            |
|     SIGCHLD     |        17        |      Ign     |             Dete-proces je prekinut.            |
|     SIGCONT     |        18        |     Cont     |               Nastavi izvr≈°avanje.              |
|     SIGSTOP     |        19        |     Stop     |              Pauziraj izvr≈°avanje.              |
|      SIGSTP     |        20        |     Stop     |   Pauziraj izvr≈°avanje (pokrenut sa terminala)  |
|     SIGTTIN     |        21        |     Stop     | Komunikacija sa terminalom za pozadinski proces |
|     SIGTTOU     |        22        |     Stop     | Komunikacija sa terminalom za pozadinski proces |

]

---

## Namena signala

.center-table.small[

| **Ime signala** | **Broj signala** | **Reakcija** |               **Svrha**               |
|:---------------:|:----------------:|:------------:|:-------------------------------------:|
|      SIGBUS     |         7        |     Core     |           Gre≈°ka magistrale           |
|     SIGPOLL     |        29        |     Term     |            Sinonim za SIGIO           |
|     SIGPROF     |        27        |     Term     |   Tajmer za profiliranje je istekao   |
|      SIGSYS     |        31        |     Core     |      Gre≈°ka u sistemskom pozivu.      |
|     SIGTRAP     |         5        |     Core     |         Breakpoint dostignut.         |
|      SIGURG     |        23        |      Ign     |      Hitna reakcija na socket-u.      |
|    ISGVTALRM    |        26        |     Term     |            Virtualni alarm            |
|     SIGXCPU     |        24        |     Core     |        Potro≈°eno svo CPU vreme.       |
|     SIGXFSZ     |        25        |     Core     | Potro≈°eno ograniƒçenje veliƒçine fajla. |
|      SIGIOT     |         6        |     Core     |          Isto ≈°to i SIGABRT.          |
|    SIGSTKFLT    |        16        |     Term     |Stek gre≈°ka na koprocesoru.(Nekori≈°ƒáeno)|
|       SIGIO     |        29        |     Term     |           I/O sada moguƒá.             |
|      SIGPWR     |        30        |     Term     |        Gre≈°ka sa napajanjem           |

]

---

## Slanje signala

```console
kill -<signall> <pid>
kill -SIGURS1 10366
``` 

---

## Slanje signala

```c
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

int main() {

    for(int i = 1; i < 99999999; i++){
        printf("%d\n", i);

        if(i == 4817)
            kill(getpid(), SIGTERM);
        }
    }
    return 0;
}
```
---

## Reagovanje na signal

```c
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

void signalCallback(int sig){
    printf("Your precious TERM signal won't save you now! I got: %d\n", sig);
}
int main() {
    signal(SIGTERM, signalCallback);

    for(int i = 1; i < 99999999; i++){
        printf("%d\n", i);

        if(i == 4817)
            kill(getpid(), SIGTERM);
        }
        if(i == 5993)
            kill(getpid(), SIGKILL);
        }
    }
    return 0;
}

```

---

## Zakazivanje

- Jako je dobra ideja da se ne specificira samo vreme nego i vrednosti za `--begin` i `--deadline` opciju koje tra≈æe idealno vreme pokretanja i rok do koga se proraƒçun treba zavr≈°iti.
- Ovo omoguƒáava inteligentnom sistemu za raspored izvr≈°avanja da udene neke procese pre na≈°eg na naƒçin koji nas ne usporava.
- Mnoge politike super-raƒçunara apsolutno zahtevaju ovakva pode≈°avanja i to sa dobrim razlogom.

---

## -J opcija

- Omoguƒáava da se specificira ime zadatka koje je razliƒçito od imena aplikacije.
- ƒåisto od administrativne vrednosti.

---

## --checkpoint opcije

- Opcija `--checkpoint=<time>` omoguƒáava da se specificira koliko vremena prolazi izmeƒëu ƒçuvanja stanja proraƒçuna na permanentnu memoriju
- `--checkpoint-dir=<path>` odreƒëuje putanju gde se stanja proraƒçuna ƒçuvaju
- `--restart-dir=<path>` odreƒëuje putanja odakle se stanja proraƒçuna uƒçitavaju, osim ako ne radimo ne≈°to jako lukavo ovo je isto kao vrednost prethodne opcije iz oƒçiglednih razloga

---

## -D opcija

- Stara se da ƒáe se proces pokrenuti u specificiranom direktorijumu, a ne u direktorijumu gde izvr≈°avamo `srun` komandu.

---

## -p opcija

- Specificira particiju na kojoj radimo
- Imamo opciju da navedemo vi≈°e particija razdvojenih dvotaƒçkama

---

## --mpi opcija

- `SLURM` samo mo≈æe da radi ovo ≈°to radi uz pomoƒá MPI protokola
- Imaju razne implementacije MPI-ja i ova opcija omoguƒáava da se izabere prava
- Za nas, to je manje-vi≈°e uvek openmpi

---

## -l opcija

- Trivijalna sa taƒçke gledi≈°ta upravljanja sistemom ali odliƒçna za nas
- `-l` nam daje oznaku na izlazu interaktivnih procesa koja specificira koji se proces startuje

---

## -K opcija

- Ako postavimo -K indikujemo da ako se bilo koji korak u zadatku zavr≈°i i vrati ne 0 nego ne≈°to drugo da ceo zadatak stane.
- Ovo je gotovo sigurno dobra ideja.

---

## salloc komanda

- Komanda ima iste parametre kao i srun i radi ne≈°to vrlo sliƒçno.
- Alocira specificirane resurse i pokreƒáe komandu koja je navedena.
- Svrha salloc jeste da komanda koju navedemo bude skripta puna srun komandi gde salloc alocira ≈°ta treba za sve zajedno, izvr≈°i ih, i onda dealocira resurse.
- `salloc` je interaktivna komanda

---

## sbatch komanda

- Slu≈æi za automatsko, grupno izvr≈°avanje posebno dizajniranih skripti
- Sbatch komanda podr≈æava izvr≈°avanje bez nadzora i automatski preusmerava ispis na izlazu skripte koju pokreƒáe.
- ƒåim se izvr≈°i, ona vrati kontrolu korisniku, a resursi se alociraju i posao odradi kasnije.
- Prosleƒëena skripta se, fiziƒçki, pokreƒáe na prvom od alociranih ƒçvorova.
- Izlaz ƒáe se naƒái u fajlovima oblika `slurm-<n>.out` gde je `<n>` broj posla.

---

## Nizovi poslova

- Jedan vrlo efektan naƒçin da se pokrene vi≈°e stvari istovremeno jeste da se radi sa nizom poslova.
- Ako mi ne ≈æelimo da uradimo 30 razliƒçitih stvari, recimo, nego istu stvar (sa drugim podacima) 30 puta (≈°to je realistiƒçna moguƒánost) onda je niz idealan metod.
- Za≈°to je ovo bolje? Zato ≈°to `SLURM` unapred zna ≈°ta to hoƒáemo da uradimo i mnogo manje napadamo sistem zakazivanja izvr≈°avanja ≈°to je slaba taƒçka `SLURM` sistema.

---

## Nizovi poslova

- Opcija da zahtevamo niz u sbatch komandi je -a praƒáena specifikacijom niza praƒáena opcionim ograniƒçenjem konkurentnosti
- Specifikacija niza je ili:
    - indeksi razdvojeni zarezima
    - Raspon (tj. dva broja razdvojena crticom, npr. 2-7)
    - Raspon sa korakom (tj. dva broja razdvojena crticom praƒáena dvotaƒçkom i korakom koji se koristi u brojanju izmeƒëu te dve vrednosti, npr. 2-10:2 ≈°to znaƒçi od 2 do 10 u koracima po 2)

- Ograniƒçenje konkurentnosti ide posle specifikacije niza i sastoji se od znaka `%` posle koga ide broj poslova koji se sme istovremeno izvr≈°avati.

---

## Kontrola imena izlaznih fajlova
- Jako nam je bitno da izlazni fajlovi imaju dobra imena. Za≈°to? Zato ≈°to ƒáe tu biti na≈°i (dragoceni) rezultati. Ako ih izgubimo ili prepi≈°emo jedne preko drugih uzalud smo raƒçunali.
- `-o opcija` defini≈°e format imena izlaznog fajla sa odreƒëenim specijalizovanim simbolima koji se prilikom procesiranja posebno interpretiraju.
- `%A` ƒáe biti zamenjen identifikatorom niza
- `%a` ƒáe biti zamenjen indeksom posla unutar niza
- `%j` ƒáe biti zamenjen jedinstvenim brojem posla (ako ne koristimo nizove)
- `%N` je ime prvog ƒçvora koji je alociran za posao.
- `%u` je ime korisnika koji je sve ovo pokrenuo

---

## Pisanje sbatch skripti

- sbatch ima posban format za skripte
- U osnovi to su shell skripte iz Unix sveta sa par malih modifikacija
- Glavne modifikacije u odnosu na shell skripte su:
    - Prisustvo posebnih promenljivih koje nam daje `SLURM`
    - `SBATCH` komentari

- `SBATCH` komentari su komentari koji poƒçinju sa `#SBATCH` is posle kojih ide razmak a onda neki od parametara koji smo radili za srun opciju

---

## Shell skripte?

- Shell je kako se zove interpreter koji obraƒëuje interakciju korisnika sa komandnom linijom.
- Danas je manje-vi≈°e standard *Bourne Again Shell* odn. `bash.` (zsh je popularan kod programera, ali se ne koristi za ovakve stvari).
- Shell skripta je naƒçin da se izvr≈°i vi≈°e korisniƒçkih komandi, tipiƒçno na ne-interaktivan naƒçin.
- Windows ekvivalent su `.bat` fajlovi.

---

## Format shell skripte

- To je fundamentalno samo tekstualni fajl, ni≈°ta vi≈°e
- Tipiƒçna ekstenzija je `.sh`, mada se skripte za sbatch ƒçesto pi≈°u sa `.sbatch` ekstenzijom.
- Ako ≈æelimo da se skripta sama izvr≈°ava onda mora poƒçinjati sa posebnom linijom: `#!/bin/bash`
- Komentari u `shell` skriptama poƒçinju sa znakom `#` i traju do kraja linije
- Sve ostale linije su komande koje se izvr≈°avaju

---

## Promenljive u shell skriptama

- Pi≈°u se svim velikim slovima
- Traju samo u fajlu u kojem se izvr≈°avaju, ali mogu da uƒçitaju vrednosti spolja, tj. iz okru≈æenja `shell`-a koji skriptu pokreƒáe.
- Da bi ih podesili dovoljno je da napi≈°emo: `MYVAR = "vrednost"`
- Da bi ih iskoristili stavljamo ispred njihovog imena $, tako da da bi napravili fajl koji se zove po onome ≈°to je u `MYVAR` stavili bi ouch $MYVAR

- Ako postoji konfuzija oko toga gde se ime promenljive zavr≈°ava koriste se velike zagrade ovako:
```console
MYVAR="vrednost" 
I="4" 
touch ${MYVAR}_${I}
```

---

## Linux sistemske promenljive

- Ako hoƒáemo da na≈°a promenljiva bude dostupna ≈°ire, sve ≈°to treba da uradimo jeste da ispred dodele vrednosti promenljive stavimo `export` ovako: 
    - `export $A="vrednost"`

- Ovako se pode≈°ava mnogo stvari u Linux sistemima: kada se ulogujete izvr≈°e se skripte (`.bashrc` i `.profile`) koje izpode≈°avaju razne sistemske promenljive na takav naƒçin da su dostupne svakom programu koji pokrenete kao pod-proces procesa koji je pozvao export (≈°to je svaki program ako je export pozvao `login shell`).

---

## Primer sbatch skripte

```console
#!/bin/bash 
# tophat_arrays.sbatch 
# 
#SBATCH -J tophat 
# A single job name for the array 
#SBATCH -p serial_requeue 
# Partition #SBATCH -n 1 
# one core #SBATCH -N 1 
# on one node #SBATCH -t 0-2:00 
# Running time of 2 hours #SBATCH --mem 4000 
# Memory request of 4 GB #SBATCH -o tophat_%A_%a.out 
# Standard output #SBATCH -e tophat_%A_%a.err 
# Standard error

mkdir trans${SLURM_ARRAY_TASK_ID}_out
cd trans${SLURM_ARRAY_TASK_ID}_out

tophat /n/informatics/databases/Mus_musculus/UCSC/mm10/Sequence/BowtieIndex \
../trans${SLURM_ARRAY_TASK_ID}.fq
```

.footer.medium[
  [Detaljnije](https://www.rc.fas.harvard.edu/resources/documentation/submitting-large-numbers-of-jobs-to-odyssey/)

] 

---

## `SLURM` sistemske promenljive

.center-table.small[

|       **Promenljiva**      |                 **Znaƒçenje**                 |
|:--------------------------:|:--------------------------------------------:|
|        SLURM_NTASKS        |          ≈†ta je prosleƒëeno -N opciji         |
|    SLURM_NTASKS_PER_CORE   |  ≈†ta je prosleƒëeno --ntasks_per_core opciji  |
|    SLURM_NTASKS_PER_NODE   |  ≈†ta je prosleƒëeno --ntasks_per_node opciji  |
|   SLURM_NTASKS_PER_SOCKET  | ≈†ta je prosleƒëeno --ntasks_per_socket opciji |
|     SLURM_CPUS_PER_TASK    |          ≈†ta je prosleƒëeno -c opciji         |
|     SLURM_DISTRIBUTION     |          ≈†ta je prosleƒëeno -m opciji         |
|    SLURM_JOB_DEPENDENCY    |          ≈†ta je prosleƒëeno -d opciji         |
| SLURM_CHECKPOINT_IMAGE_DIR |   ≈†ta je prosleƒëeno --checkpoint-dir opciji  |
|        SLURM_NNODES        |       Broj ƒçvorova alociranih za posao       |
|   SLURM_JOB_CPUS_PER_NODE  |      Koliko imamo CPU-ova na ovom ƒçvoru      |
|     SLURM_CPUS_ON_NODE     |   Koliko ima CPU-ova na ovom ƒçvoru ukupno.   |
|      SLURM_SUBMIT_HOST     |      Ime raƒçunara odakle potiƒçe zadatak      |
|     SLURM_CLUSTER_NAME     |      Ime klastera gde se posao izvr≈°ava      |

]

---

## `SLURM` sistemske promenljive

.center-table.small[

|    **Promenljiva**    |                  **Znaƒçenje**                 |
|:---------------------:|:---------------------------------------------:|
|  SLURM_JOB_PARTITION  |      Ime particjie gde se posao izvr≈°ava      |
|      SLURM_JOBID      |              ID trenutnog zadatka             |
|     SLURM_LOCALID     |         PID trenutnog procesa na ƒçvoru        |
|      SLURM_NODEID     |                ID tekuƒáeg ƒçvora               |
|      SLURM_PROCID     |          Globalno-validan ID procesa          |
|   SLURM_JOB_NODELIST  |     Lista svih ƒçvorova alociranih zadatku     |
|  SLURM_TASKS_PER_NODE |   Koliko se stvari izvr≈°ava na svakom ƒçvoru   |
|  SLURM_ARRAY_TASK_ID  | Niz indeksa zadatak u okviru niza, ako ga ima |
|  SLURM_ARRAY_TASK_MIN | Niz indeksa zadatak u okviru niza, ako ga ima |
|  SLURM_ARRAY_TASK_MIN |        Najmanji indeks niza, ako ga ima       |
|  SLURM_ARRAY_TASK_MAX |        Najveƒái indeks niza, ako ga ima        |
| SLURM_ARRAY_TASK_STEP |         Korak u brojanju indeksa niza         |
|   SLURM_ARRAY_JOB_ID  |           ID celog niza, ako ga ima           |

]

---

## Jednostavan primer `SLURM` promenjevih

```console
#!/bin/bash
export OMP_NUM_THREADS=$SLURM_CPUS_PER_TASK
./omp_program
```

---

## Dodatne korisne `SLURM` komande

- `squeue`
    - Prikazuje poslove koji se izvr≈°avaju ili koji ƒçekaju i njihov status.
- `scancel`
    - Otkazuje izvr≈°avanje zakazanog posla.
-`sacct`
    - Prikazuje agregirane statistiƒçke podatke o radu klastera.
- `sinfo`
    - Prikazuje podatke o konfiguraciji klastera

--

class: center, middle, theend, hide-text
layout: false
background-image: url(../theend.gif)

</textarea> <script src="https://remarkjs.com/downloads/remark-latest.min.js"></script> <script>remark.macros.scale=function(percentage){var url=this;return'<div class="center"><img src="' +url+'" style="width: '+percentage+'" /></div>';};var slideshow=remark.create({highlightLanguage:'python',highlightStyle:'monokai',highlightLines:true,countIncrementalSlides:false,navigation:{scroll:false,}});</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.min.js"></script> <script>mermaid.initialize({startOnLoad:true});</script></body></html>